"use strict";var ApplicationConfiguration=function(){var applicationModuleName="enrtama",applicationModuleVendorDependencies=["ngResource","ngCookies","ngAnimate","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.utils","duScroll","pascalprecht.translate","xeditable","toasty","ui.calendar","ui.sortable","ngFlag"],registerModule=function(moduleName,dependencies){angular.module(moduleName,dependencies||[]),angular.module(applicationModuleName).requires.push(moduleName)};return{applicationModuleName:applicationModuleName,applicationModuleVendorDependencies:applicationModuleVendorDependencies,registerModule:registerModule}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("!")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])}),ApplicationConfiguration.registerModule("articles"),ApplicationConfiguration.registerModule("contacts"),ApplicationConfiguration.registerModule("core"),ApplicationConfiguration.registerModule("users"),angular.module("articles").run(["Menus",function(Menus){Menus.addMenuItem("topbar","Articles","articles","dropdown","/articles(/create)?"),Menus.addSubMenuItem("topbar","articles","List Articles","articles"),Menus.addSubMenuItem("topbar","articles","New Article","articles/create")}]),angular.module("articles").config(["$stateProvider",function($stateProvider){$stateProvider.state("listArticles",{url:"/articles",templateUrl:"modules/articles/views/list-articles.client.view.html"}).state("createArticle",{url:"/articles/create",templateUrl:"modules/articles/views/create-article.client.view.html"}).state("viewArticle",{url:"/articles/:articleId",templateUrl:"modules/articles/views/view-article.client.view.html"}).state("editArticle",{url:"/articles/:articleId/edit",templateUrl:"modules/articles/views/edit-article.client.view.html"})}]),angular.module("articles").controller("ArticlesController",["$scope","$stateParams","$location","Authentication","Articles","toasty",function($scope,$stateParams,$location,Authentication,Articles,toasty){$scope.authentication=Authentication,$scope.create=function(){var article=new Articles({title:this.title,content:this.content});article.$save(function(response){$location.path("articles/"+response._id),$scope.title="",$scope.content=""},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.remove=function(article){if(article){article.$remove();for(var i in $scope.articles)$scope.articles[i]===article&&$scope.articles.splice(i,1)}else $scope.article.$remove(function(){toasty.pop.success({title:"The article has been removed!",sound:!1,showClose:!0,clickToClose:!1}),$location.path("articles")})},$scope.update=function(article){article.$update(function(){toasty.pop.success({title:"The article has been updated!",sound:!1,showClose:!0,clickToClose:!1}),$location.path("articles")},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.find=function(){$scope.articles=Articles.query()},$scope.findOne=function(){$scope.article=Articles.get({articleId:$stateParams.articleId})}}]),angular.module("articles").factory("Articles",["$resource",function($resource){return $resource("articles/:articleId",{articleId:"@_id"},{update:{method:"PUT"}})}]),angular.module("contacts").run(["Menus",function(Menus){Menus.addMenuItem("topbar","Contacts","contacts","dropdown","/contacts(/create)?"),Menus.addSubMenuItem("topbar","contacts","List Contacts","contacts")}]),angular.module("contacts").config(["$stateProvider",function($stateProvider){$stateProvider.state("listContacts",{url:"/contacts",templateUrl:"modules/contacts/views/list-contacts.client.view.html"}).state("createContact",{url:"/contacts/create",templateUrl:"modules/contacts/views/create-contact.client.view.html"}).state("viewContact",{url:"/contacts/:contactId",templateUrl:"modules/contacts/views/view-contact.client.view.html"}).state("editContact",{url:"/contacts/:contactId/edit",templateUrl:"modules/contacts/views/edit-contact.client.view.html"})}]),angular.module("contacts").controller("ContactsController",["$scope","$stateParams","$location","Authentication","$modal","Contacts","$log","toasty",function($scope,$stateParams,$location,Authentication,$modal,Contacts,$log,toasty){$scope.authentication=Authentication,$scope.create=function(){var contact=new Contacts({name:this.name});contact.$save(function(response){$location.path("contacts/"+response._id),$scope.name=""},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.remove=function(contact){if(contact){var modalInstance=$modal.open({templateUrl:"modules/core/views/modal.client.view.html",controller:"ModalInstanceController",resolve:{content:function(){return{header:"Delete contact",body:"Are you sure you want to delete?",object:contact}}}});modalInstance.result.then(function(){contact.$remove();for(var i in $scope.contacts)$scope.contacts[i]===contact&&$scope.contacts.splice(i,1);toasty.pop.success({title:"The contact has been deleted!",sound:!1,showClose:!0,clickToClose:!1})},function(){})}else $scope.contact.$remove(function(){$location.path("contacts")})},$scope.update=function(contact){contact.$update(function(){toasty.pop.success({title:"The contact has been updated!",sound:!1,showClose:!0,clickToClose:!1}),$location.path("contacts")},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.find=function(){$scope.contacts=Contacts.query()},$scope.findOne=function(){$scope.contact=Contacts.get({contactId:$stateParams.contactId})}}]),angular.module("contacts").factory("Contacts",["$resource",function($resource){return $resource("contacts/:contactId",{contactId:"@_id"},{update:{method:"PUT"}})}]),angular.module("core").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("calendar",{url:"/calendar",templateUrl:"modules/core/views/calendar.client.view.html"}).state("home",{url:"/",templateUrl:"modules/core/views/home.client.view.html"})}]);var translationsES={ARTICLES:"Artículos",CONTACTS:"Contactos",CALENDAR:"Calendario",PROFILE:"Editar Perfil",SOCIAL_ACCOUNTS:"Redes Sociales",CHANGE_PASSWORD:"Cambiar Password",SIGNIN:"Entrar",SIGNOUT:"Salir",MENU_ABOUT:"Sobre Mí",MENU_PROJECTS:"Proyectos",MENU_CONTACT:"Contacto",SELF_DESCRIPTION1:"Soy español y tengo 25 años.",SELF_DESCRIPTION2:"Actualmente vivo en Amsterdam y trabajo como desarrollador Frontend y Backend.",FRONTEND:"Frontend",BACKEND:"Backend",DATABASE:"Base de Datos",PROJECTS_LAYERGLOSS:"Plataforma basada en el concepto de Drag, Drop & Publish. Con esta herramienta es muy fácil la creación de apps tanto para iOS como para Android en cuestión de minutos, en vez de días y por un precio mucho mas reducido. Combinamos la facilidad de uso con la rapidez de creación.",PROJECTS_MARIATAMAMES:"Página web personal de la diseñadora Maria Tamames.",PROJECTS_XGEN:"XGen es un sistema de generación dinámica de formularios atendiendo a los estándares de XFORMS. El usuario puede construir sus propios formularios, crear nuevos campos y editarlos de una forma muy fácil (WYSUWYG)",PROJECTS_DKT:"Página web personal de la peña DKT.",PROJECTS_PINAPARDO:"Es una proyecto textil y de moda dedicado a la artesanía, collage y proyectos visuales. PINAPARDO nació en el seno del núcleo con preguntas y preocupaciones. Llega antes de la necesidad para encontrar respuestas. Es una forma de expresión personal.",PROJECTS_ELVIRA:"Fisioterapia usando técnicas manuales e instrumentos físicos para mejorar tu calidad de vida.",USERNAME:"Usuario",PASSWORD:"Contraseña",EMAIL:"Correo electrónico",MESSAGE:"Mensaje",FOOTER:"2015 Enrique Tamames. Todos los derechos reservados",SEND_BUTTON:"Enviar"},translationsEN={ARTICLES:"Articles",CONTACTS:"Contacts",CALENDAR:"Calendar",PROFILE:"Edit profile",SOCIAL_ACCOUNTS:"Manage Social Accounts",CHANGE_PASSWORD:"Change Password",SIGNIN:"Signin",SIGNOUT:"Signout",MENU_ABOUT:"About",MENU_PROJECTS:"Projects",MENU_CONTACT:"Contact",SELF_DESCRIPTION1:"I'm spanish and I'm 25 years old.",SELF_DESCRIPTION2:"Currently living in Amsterdam and working as both Frontend & Backend developer.",FRONTEND:"Frontend",BACKEND:"Backend",DATABASE:"Database",PROJECTS_LAYERGLOSS:"App production platform based on the concept of Drag, Drop and Publish. With this tool it's very easy to create apps for the Apple iOs platform in minutes, instead of days and at a fraction of the cost that others charge. We combine easy to use with fast to create.",PROJECTS_MARIATAMAMES:"Personal website of Maria Tamames, fashion designer.",PROJECTS_XGEN:"XGen is a system which manages the generation of dynamic forms according to the XFORMS specification. The user can build his own forms, create new fields & edit them in a easy way (WYSIWYG).",PROJECTS_DKT:"Página web personal de la peña DKT.",PROJECTS_PINAPARDO:"PINAPARDO is a Slow Fashion&Textile Crafts, collage and visuals project. PINAPARDO was born in the bosom of a core fulfilled with worries and questions. It arises before the imminent need to find the answers. A way of personal expression.",PROJECTS_ELVIRA:"Physiotherapy by using manual techniques and phisical instruments in order to improve your quality of live.",USERNAME:"Username",PASSWORD:"Password",EMAIL:"Email",MESSAGE:"Message",FOOTER:"2015 Enrique Tamames. All Rights Reserved",SEND_BUTTON:"Send"};angular.module("core").config(["$translateProvider",function($translateProvider){$translateProvider.translations("en",translationsEN).translations("es",translationsES).preferredLanguage("en").fallbackLanguage("en")}]),angular.module("core").controller("CalendarController",["$scope","$compile","uiCalendarConfig",function($scope,$compile){var date=new Date,d=date.getDate(),m=date.getMonth(),y=date.getFullYear();$scope.changeTo="Hungarian",$scope.eventSource={url:"http://www.google.com/calendar/feeds/usa__en%40holiday.calendar.google.com/public/basic",className:"gcal-event",currentTimezone:"America/Chicago"},$scope.events=[{title:"All Day Event",start:new Date(y,m,1)},{title:"Long Event",start:new Date(y,m,d-5),end:new Date(y,m,d-2)},{id:999,title:"Repeating Event",start:new Date(y,m,d-3,16,0),allDay:!1},{id:999,title:"Repeating Event",start:new Date(y,m,d+4,16,0),allDay:!1},{title:"Birthday Party",start:new Date(y,m,d+1,19,0),end:new Date(y,m,d+1,22,30),allDay:!1},{title:"Click for Google",start:new Date(y,m,28),end:new Date(y,m,29),url:"http://google.com/"}],$scope.eventsF=function(start,end,timezone,callback){var s=new Date(start).getTime()/1e3,m=(new Date(end).getTime()/1e3,new Date(start).getMonth()),events=[{title:"Feed Me "+m,start:s+5e4,end:s+1e5,allDay:!1,className:["customFeed"]}];callback(events)},$scope.calEventsExt={color:"#f00",textColor:"yellow",events:[{type:"party",title:"Lunch",start:new Date(y,m,d,12,0),end:new Date(y,m,d,14,0),allDay:!1},{type:"party",title:"Lunch 2",start:new Date(y,m,d,12,0),end:new Date(y,m,d,14,0),allDay:!1},{type:"party",title:"Click for Google",start:new Date(y,m,28),end:new Date(y,m,29),url:"http://google.com/"}]},$scope.alertOnEventClick=function(date){$scope.alertMessage=date.title+" was clicked "},$scope.alertOnDrop=function(event,delta){$scope.alertMessage="Event Droped to make dayDelta "+delta},$scope.alertOnResize=function(event,delta){$scope.alertMessage="Event Resized to make dayDelta "+delta},$scope.addRemoveEventSource=function(sources,source){var canAdd=0;angular.forEach(sources,function(value,key){sources[key]===source&&(sources.splice(key,1),canAdd=1)}),0===canAdd&&sources.push(source)},$scope.addEvent=function(){$scope.events.push({title:"Open Sesame",start:new Date(y,m,28),end:new Date(y,m,29),className:["openSesame"]})},$scope.remove=function(index){$scope.events.splice(index,1)},$scope.changeView=function(view,calendar){uiCalendarConfig.calendars[calendar].fullCalendar("changeView",view)},$scope.renderCalender=function(calendar){uiCalendarConfig.calendars[calendar]&&uiCalendarConfig.calendars[calendar].fullCalendar("render")},$scope.eventRender=function(event,element){element.attr({tooltip:event.title,"tooltip-append-to-body":!0}),$compile(element)($scope)},$scope.uiConfig={calendar:{height:450,editable:!0,header:{left:"title",center:"",right:"today prev,next"},eventClick:$scope.alertOnEventClick,eventDrop:$scope.alertOnDrop,eventResize:$scope.alertOnResize,eventRender:$scope.eventRender}},$scope.changeLang=function(){"Hungarian"===$scope.changeTo?($scope.uiConfig.calendar.dayNames=["Vasárnap","Hétfő","Kedd","Szerda","Csütörtök","Péntek","Szombat"],$scope.uiConfig.calendar.dayNamesShort=["Vas","Hét","Kedd","Sze","Csüt","Pén","Szo"],$scope.changeTo="English"):($scope.uiConfig.calendar.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$scope.uiConfig.calendar.dayNamesShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],$scope.changeTo="Hungarian")},$scope.eventSources=[$scope.events,$scope.eventSource,$scope.eventsF],$scope.eventSources2=[$scope.calEventsExt,$scope.eventsF,$scope.events],$scope.eventSources=[$scope.events]}]),angular.module("core").controller("FooterController",["$scope",function(){}]),angular.module("core").controller("HeaderController",["$scope","Authentication","Menus",function($scope,Authentication,Menus){$scope.authentication=Authentication,$scope.isCollapsed=!1,$scope.menu=Menus.getMenu("topbar"),$scope.toggleCollapsibleMenu=function(){$scope.isCollapsed=!$scope.isCollapsed},$scope.$on("$stateChangeSuccess",function(){$scope.isCollapsed=!1})}]),angular.module("core").value("duScrollDuration",500).value("duScrollOffset",30).controller("HomeController",["$scope","Authentication","$log","$translate",function($scope,Authentication,$log,$translate){$scope.authentication=Authentication,$scope.sections=angular.element($(".section").css("height",window.screen.availHeight)),$scope.myInterval=2e3,$scope.alerts=[{type:"danger",msg:"Oh snap! Change a few things up and try submitting again."},{type:"success",msg:"Well done! You successfully read this important alert message."}],$scope.user={name:"awesome user"},$scope.changeLanguage=function(e,language){$translate.use(language);var current=angular.element(e.currentTarget),languageOptions=angular.element($(".flag"));angular.forEach(languageOptions,function(option){var element=angular.element(option);element.hasClass("selected")&&(element.removeClass("selected"),element.addClass("unselected"))}),current.addClass("selected")},$translate(["TITLE","TEXT","BUTTON_LANG_EN","BUTTON_LANG_ES"]).then(function(translations){$scope.title=translations.TITLE,$scope.text=translations.TEXT,$scope.buttonEnglish=translations.BUTTON_LANG_EN,$scope.buttonSpanish=translations.BUTTON_LANG_ES});var i;for($scope.itemsList={items1:[],items2:[]},i=0;5>=i;i+=1)$scope.itemsList.items1.push({Id:i,Label:"Item "+i});for(i=0;5>=i;i+=1)$scope.itemsList.items2.push({Id:i,Label:"Item 2_"+i});$scope.sortableOptions={containment:"#sortable-container",accept:function(sourceItemHandleScope,destSortableScope){return sourceItemHandleScope.itemScope.sortableScope.$id===destSortableScope.$id}}}]),angular.module("core").controller("SubmitController",["$scope","$http","$location","Authentication","$translate","Contacts","toasty",function($scope,$http,$location,Authentication,translate,Contacts,toasty){$scope.submit=function(){var contact=new Contacts({username:$scope.contact.username,email:$scope.contact.email,message:$scope.contact.message});contact.$save(function(){toasty.pop.success({title:"Your message has been sent successfully!",sound:!1,showClose:!0,clickToClose:!1}),$scope.username="",$scope.email="",$scope.message=""},function(errorResponse){$scope.error=errorResponse.data.message})}}]),angular.module("core").run(["editableOptions",function(editableOptions){editableOptions.theme="bs3"}]),angular.module("core").controller("ModalInstanceController",["$scope","$modalInstance","content",function($scope,$modalInstance,content){$scope.header=content.header,$scope.body=content.body,$scope.object=content.object,$scope.ok=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}]),angular.module("core").service("Menus",[function(){this.defaultRoles=["*"],this.menus={};var shouldRender=function(user){if(!user)return this.isPublic;if(~this.roles.indexOf("*"))return!0;for(var userRoleIndex in user.roles)for(var roleIndex in this.roles)if(this.roles[roleIndex]===user.roles[userRoleIndex])return!0;return!1};this.validateMenuExistance=function(menuId){if(menuId&&menuId.length){if(this.menus[menuId])return!0;throw new Error("Menu does not exists")}throw new Error("MenuId was not provided")},this.getMenu=function(menuId){return this.validateMenuExistance(menuId),this.menus[menuId]},this.addMenu=function(menuId,isPublic,roles){return this.menus[menuId]={isPublic:isPublic||!1,roles:roles||this.defaultRoles,items:[],shouldRender:shouldRender},this.menus[menuId]},this.removeMenu=function(menuId){this.validateMenuExistance(menuId),delete this.menus[menuId]},this.addMenuItem=function(menuId,menuItemTitle,menuItemURL,menuItemType,menuItemUIRoute,isPublic,roles,position){return this.validateMenuExistance(menuId),this.menus[menuId].items.push({title:menuItemTitle,link:menuItemURL,menuItemType:menuItemType||"item",menuItemClass:menuItemType,uiRoute:menuItemUIRoute||"/"+menuItemURL,isPublic:null===isPublic||"undefined"==typeof isPublic?this.menus[menuId].isPublic:isPublic,roles:null===roles||"undefined"==typeof roles?this.menus[menuId].roles:roles,position:position||0,items:[],shouldRender:shouldRender}),this.menus[menuId]},this.addSubMenuItem=function(menuId,rootMenuItemURL,menuItemTitle,menuItemURL,menuItemUIRoute,isPublic,roles,position){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].link===rootMenuItemURL&&this.menus[menuId].items[itemIndex].items.push({title:menuItemTitle,link:menuItemURL,uiRoute:menuItemUIRoute||"/"+menuItemURL,isPublic:null===isPublic||"undefined"==typeof isPublic?this.menus[menuId].items[itemIndex].isPublic:isPublic,roles:null===roles||"undefined"==typeof roles?this.menus[menuId].items[itemIndex].roles:roles,position:position||0,shouldRender:shouldRender});return this.menus[menuId]},this.removeMenuItem=function(menuId,menuItemURL){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].link===menuItemURL&&this.menus[menuId].items.splice(itemIndex,1);return this.menus[menuId]},this.removeSubMenuItem=function(menuId,submenuItemURL){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)for(var subitemIndex in this.menus[menuId].items[itemIndex].items)this.menus[menuId].items[itemIndex].items[subitemIndex].link===submenuItemURL&&this.menus[menuId].items[itemIndex].items.splice(subitemIndex,1);return this.menus[menuId]},this.addMenu("topbar")}]),angular.module("users").config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$q","$location","Authentication",function($q,$location,Authentication){return{responseError:function(rejection){switch(rejection.status){case 401:Authentication.user=null,$location.path("signin");break;case 403:}return $q.reject(rejection)}}}])}]),angular.module("users").config(["$stateProvider",function($stateProvider){$stateProvider.state("profile",{url:"/settings/profile",templateUrl:"modules/users/views/settings/edit-profile.client.view.html"}).state("password",{url:"/settings/password",templateUrl:"modules/users/views/settings/change-password.client.view.html"}).state("accounts",{url:"/settings/accounts",templateUrl:"modules/users/views/settings/social-accounts.client.view.html"}).state("signup",{url:"/signup",templateUrl:"modules/users/views/authentication/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/users/views/authentication/signin.client.view.html"}).state("forgot",{url:"/password/forgot",templateUrl:"modules/users/views/password/forgot-password.client.view.html"}).state("reset-invalid",{url:"/password/reset/invalid",templateUrl:"modules/users/views/password/reset-password-invalid.client.view.html"}).state("reset-success",{url:"/password/reset/success",templateUrl:"modules/users/views/password/reset-password-success.client.view.html"}).state("reset",{url:"/password/reset/:token",templateUrl:"modules/users/views/password/reset-password.client.view.html"})}]),angular.module("users").controller("AuthenticationController",["$scope","$http","$location","Authentication",function($scope,$http,$location,Authentication){$scope.authentication=Authentication,$scope.authentication.user&&$location.path("/"),$scope.signup=function(){$http.post("/auth/signup",$scope.credentials).success(function(response){$scope.authentication.user=response,$location.path("/")}).error(function(response){$scope.error=response.message})},$scope.signin=function(){$http.post("/auth/signin",$scope.credentials).success(function(response){$scope.authentication.user=response,$location.path("/")}).error(function(response){$scope.error=response.message})}}]),angular.module("users").controller("PasswordController",["$scope","$stateParams","$http","$location","Authentication",function($scope,$stateParams,$http,$location,Authentication){$scope.authentication=Authentication,$scope.authentication.user&&$location.path("/"),$scope.askForPasswordReset=function(){$scope.success=$scope.error=null,$http.post("/auth/forgot",$scope.credentials).success(function(response){$scope.credentials=null,$scope.success=response.message}).error(function(response){$scope.credentials=null,$scope.error=response.message})},$scope.resetUserPassword=function(){$scope.success=$scope.error=null,$http.post("/auth/reset/"+$stateParams.token,$scope.passwordDetails).success(function(response){$scope.passwordDetails=null,Authentication.user=response,$location.path("/password/reset/success")}).error(function(response){$scope.error=response.message})}}]),angular.module("users").controller("SettingsController",["$scope","$http","$location","Users","Authentication",function($scope,$http,$location,Users,Authentication){$scope.user=Authentication.user,$scope.user||$location.path("/"),$scope.hasConnectedAdditionalSocialAccounts=function(){for(var i in $scope.user.additionalProvidersData)return!0;return!1},$scope.isConnectedSocialAccount=function(provider){return $scope.user.provider===provider||$scope.user.additionalProvidersData&&$scope.user.additionalProvidersData[provider]},$scope.removeUserSocialAccount=function(provider){$scope.success=$scope.error=null,$http["delete"]("/users/accounts",{params:{provider:provider}}).success(function(response){$scope.success=!0,$scope.user=Authentication.user=response}).error(function(response){$scope.error=response.message})},$scope.updateUserProfile=function(isValid){if(isValid){$scope.success=$scope.error=null;var user=new Users($scope.user);user.$update(function(response){$scope.success=!0,Authentication.user=response},function(response){$scope.error=response.data.message})}else $scope.submitted=!0},$scope.changeUserPassword=function(){$scope.success=$scope.error=null,$http.post("/users/password",$scope.passwordDetails).success(function(){$scope.success=!0,$scope.passwordDetails=null}).error(function(response){$scope.error=response.message})}}]),angular.module("users").factory("Authentication",[function(){var _this=this;return _this._data={user:window.user},_this._data}]),angular.module("users").factory("Users",["$resource",function($resource){return $resource("users",{},{update:{method:"PUT"}})}]);